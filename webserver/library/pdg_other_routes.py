#!/usr/bin/env python3

"""
Physics Derivation Graph
Ben Payne, 2025
http://creativecommons.org/licenses/by/4.0/
Attribution 4.0 International (CC BY 4.0)
"""

import logging

logger = logging.getLogger(__name__)

from initialize_flask import web_app

from flask import (
    render_template,
    make_response,
)  # https://stackoverflow.com/a/35672990/1164295


###########################################################################

@web_app.route("/api_via_js")
def to_api_via_js() -> str:
    """
    HTML page created with help from Google's Gemini 2.0 LLM (free!) 2025-01-xx
    """
    return render_template("js_with_api/api_js.html")


###########################################################################

@web_app.route("/api_documentation")
def to_api_documenation() -> str:
    """
    HTML page generated by Google's Gemini 2.0 LLM (free!) 2025-01-xx
    """
    return render_template("api_documentation.html")


@web_app.route("/workflow_documentation")
def to_api_documenation() -> str:
    """
    HTML page generated by Google's Gemini 2.0 LLM (free!) 2025-01-xx
    """
    return render_template("workflow_documentation.html")


###########################################################################

@web_app.route("/rss/<path:path>")
def serve(path):
    """
    TODO 

    See https://github.com/allofphysicsgraph/ui_v8_website_flask_neo4j/issues/43
    """
    response = make_response(render_template("rss.xml"))
    response.headers["Content-Type"] = "application/rss+xml"
    return response

###########################################################################

@web_app.route("/profile/", methods=["GET", "POST"])
def profile():
    """
    # TODO -- this is just a stub

    https://github.com/allofphysicsgraph/proofofconcept/issues/126
    >>>
    """
    # TODO
    sign_up_date = "2020-04-12"
    # TODO
    last_previous_contribution_date = "2020-04-10"
    # TODO
    list_of_derivs = ["fun deriv", "another deriv"]
    # TODO
    list_of_exprs = ["424252", "525252"]

    return render_template(
        "jinja2_pages/profile.html",
        # user_name=user_name,
        sign_up_date=sign_up_date,
        last_previous_contribution_date=last_previous_contribution_date,
        list_of_derivs=list_of_derivs,
        list_of_exprs=list_of_exprs,
        # title="PDG profile for " + user_name,
    )

###########################################################################

@web_app.route("/search", methods=["GET", "POST"])
def search_redirect_to_google():
    """
    rather than search local content, rely on Google's index
    """
    logger.info("[trace] search_redirect_to_google")
    logger.debug(
        "request.url: " + str(request.url)
    )  # https://stackoverflow.com/a/46176337/1164295

    # request.args are embedded in the URL
    # logger.debug("search term is " + str(request.args.get("search")))
    # logger.debug("request.args =" + str(request.args))
    logger.debug("request.form =" + str(request.form))
    logger.debug("request.form.keys() =" + str(request.form.keys()))

    return redirect(
        "https://www.google.com/search?&q=site%3Aderivationmap.net+"
        + str(request.form.get("search"))
    )

###########################################################################

@web_app.route("/favicon.ico")  #     https://www.favicongenerator.com/
@web_app.route(
    "/robots.txt"
)  # https://github.com/allofphysicsgraph/proofofconcept/issues/160
@web_app.route(
    "/sitemap.txt"
)  # https://github.com/allofphysicsgraph/proofofconcept/issues/165
def static_from_root():
    """
    https://stackoverflow.com/a/14625619/1164295
    """
    return send_from_directory(app.static_folder, request.path[1:])

###########################################################################

@web_app.route("/static_dir", methods=["GET", "POST"])
def static_dir():
    """
    "static_dir" is a directory listing
    This route is not intended to be linked to
    >>> static_dir()
    """
    trace_id = str(random.randint(1000000, 9999999))
    logger.info("[trace page start " + trace_id + "]")
    # https://stackoverflow.com/a/3207973/1164295
    (_, _, filenames) = next(os.walk("static"))
    filenames.sort()
    logger.info("[trace page end " + trace_id + "]")
    return render_template(
        "jinja2_pages/static_dir.html",
        list_of_files=filenames,
        folder_name="static",
        title="directory listing",
    )

###########################################################################

@web_app.route("/evaluation_of_LLM_prompts", methods=["GET", "POST"])
def evaluation_of_LLM_prompts():
    """ """
    logger.info("[trace page evaluation_of_LLM_prompts")
    return render_template("jinja2_pages/evaluation_of_LLM_prompts.html")

###########################################################################

@web_app.route("/user_documentation", methods=["GET", "POST"])
def user_documentation():
    """
    a static page with documentation aimed at users (not developers)

    >>> user_documentation()
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/user_documentation.html", title="User Documentation")

@web_app.route("/developer_documentation", methods=["GET", "POST"])
def developer_documentation():
    """
    a static page aimed at people interested in contributed code changes

    >>> developer_documentation()
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/developer_documentation.html", title="Developer Documentation"
    )


@web_app.route("/design_documentation", methods=["GET", "POST"])
def design_documentation():
    """
    a static page aimed at people interested in understanding
    design decisions

    >>> design_documentation()
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/design_documentation.html", title="Design Decisions Documentation"
    )


@web_app.route("/faq", methods=["GET", "POST"])
def faq():
    """
    "frequently asked questions" is a static page

    >>> faq()
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/faq.html", title="Frequently Asked Questions")

@web_app.route("/design_principles_and_goals", methods=["GET", "POST"])
def design_principles_and_goals():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/design_principles_and_goals.html", title="Design Principles and Goals"
    )

@web_app.route("/other_projects", methods=["GET", "POST"])
def other_projects():
    """
    "other projects" is a static page

    >>> other_projects()
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/other_projects.html", title="Other projects")


@web_app.route("/literature_review", methods=["GET", "POST"])
def literature_review():
    """
    "literature_review" is a static page

    >>> literature_review()
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/literature_review.html", title="Literature Review")

@web_app.route("/historical_precedents", methods=["GET", "POST"])
def historical_precedents():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/historical_precedents.html", title="historical precedents")

@web_app.route("/site_map", methods=["GET", "POST"])
def site_map():
    """
    a static page for site content

    >>> static_map()
    """
    logger.info("[trace]")
    return render_template("jinja2_pages/site_map.html", title="Site Map")


###########################################################################

@web_app.route("/comparison_of_design_options_cas", methods=["GET", "POST"])
def comparison_of_design_options_cas():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/comparison_of_design_options_cas.html",
        title="Comparison of Design Options Documentation",
    )


@web_app.route("/comparison_of_design_options_proofs", methods=["GET", "POST"])
def comparison_of_design_options_proofs():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/comparison_of_design_options_proofs.html",
        title="Comparison of Design Options Documentation",
    )

@web_app.route("/comparison_of_design_options_syntax", methods=["GET", "POST"])
def comparison_of_design_options_syntax():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/comparison_of_design_options_syntax.html",
        title="Comparison of Design Options Documentation",
    )


@web_app.route("/comparison_of_design_options_database", methods=["GET", "POST"])
def comparison_of_design_options_database():
    """
    a static page
    """
    logger.info("[trace]")
    return render_template(
        "jinja2_pages/comparison_of_design_options_database.html",
        title="Comparison of Design Options Documentation",
    )


###########################################################################

@web_app.route("/list_named_expressions", methods=["GET", "POST"])
def central_expressions():
    """
    "central expressions" is a static page

    >>> central_expressions()
    """
    logger.info("[trace]")
    return render_template("central_expressions.html", title="central expressions")

###########################################################################

@web_app.route("/blog/", methods=["GET"])
def blog_list():
    """ """
    logger.info("[trace]")
    return render_template("blog/blog_list.html")


@web_app.route("/blog/<YYYY>/<MM>/<blog_title>", methods=["GET"])
def blog(YYYY: str, MM: str, blog_title: str):
    """
    blog/YYYY/MM/blog-title

    blog()
    """
    logger.info("[trace]")
    return render_template("blog/" + YYYY + "/" + MM + "/" + blog_title)

###########################################################################

# This page appears to be statically generated. Probably remove?

@web_app.route("/clickable_layers", methods=["GET", "POST"])
def clickable_layers():
    """ """
    logger.info("[trace page clickable_layers")
    return render_template("clickable_layers.html", title="clickable_layers")

###########################################################################

@web_app.route("/class_notes", methods=["GET", "POST"])
def class_notes_without_subpage():
    """
    class notes from school
    """
    logger.info("[trace page class_notes]")
    return render_template("class_notes_overview.html", title="class notes overview")


@web_app.route("/class_notes/<which_class>", methods=["GET", "POST"])
def class_notes_subpage(which_class: str):
    """
    class notes from school
    """
    trace_id = str(random.randint(1000000, 9999999))
    logger.info("[trace page start " + trace_id + "] ")

    if which_class == "overview":
        logger.info("URL is overview")
        logger.info("[trace page end " + trace_id + "]")
        return render_template("class_notes_overview.html", title="overview")
    elif which_class == "math402_mathematical_physics_hale":
        logger.info("URL is 402")
        logger.info("[trace page end " + trace_id + "]")
        return render_template(
            "class_notes_math402_mathematical_physics_hale.html", title="Math 402"
        )

    logger.info("[trace page end " + trace_id + "]")
    return render_template("class_notes_overview.html", title="class notes overview")

###########################################################################

@web_app.route("/roadmap", methods=["GET", "POST"])
@web_app.route("/roadmap/overview", methods=["GET", "POST"])
def roadmap():
    """
    exploration of layering formalization
    """
    return render_template("layers_overview.html", title="Roadmap Overview")


@web_app.route("/roadmap/lecture", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_lecture_video.html", title=page_title)

@web_app.route("/roadmap/handwritten", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_handwritten_notes.html", title=page_title)

@web_app.route("/roadmap/latex", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template(
            "layers_document_without_decorations.html", title=page_title
        )

@web_app.route("/roadmap/tag_sections", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template(
            "layers_section_document_structure.html", title=page_title
        )

@web_app.route("/roadmap/tag_words", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template(
            "layers_words_named_entity_recognition.html", title=page_title
        )

@web_app.route("/roadmap/tag_expressions", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_contentML.html", title=page_title)
    
@web_app.route("/roadmap/tag_all", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_sections_words_contentML.html", title=page_title)

@web_app.route("/roadmap/variables", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_concepts_to_variables.html", title=page_title)

@web_app.route("/roadmap/all_steps", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_all_steps.html", title=page_title)

@web_app.route("/roadmap/pdg", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_derivation_graph.html", title=page_title)
            
@web_app.route("/roadmap/CAS_validation", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_validate_steps.html", title=page_title)
@web_app.route("/roadmap/numeric_id", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template(
            "layers_replace_variables_with_numeric_id.html", title=page_title
        )
@web_app.route("/roadmap/dimensional_validation", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_dimensional_validation.html", title=page_title)
@web_app.route("/roadmap/proof", methods=["GET", "POST"])
def roadmap_layer():
    """
    exploration of layering formalization
    """
    page_title = "Roadmap for Formal Mathematical Physics Content"
    return render_template("layers_proof_of_inference_rule.html", title=page_title)

###########################################################################

###########################################################################

###########################################################################